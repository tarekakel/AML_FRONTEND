<div class="flex h-screen bg-gray-50">
    <!-- Sidebar: Categories -->
    <div class="w-64 bg-white border-r shadow-md">
        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-t-lg border-b shadow-sm">
            <h2 class="text-xl font-semibold text-gray-800">
                Risk Categories
            </h2>
            <button
                class="flex items-center px-3 py-1.5 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 shadow"
                (click)="openAddEditCategory(null)">
                <span class="mr-1 text-lg">‚ûï</span>
            </button>
        </div>
        <ul>
            <li *ngFor="let cat of categories" (click)="selectCategory(cat)"
                [class.bg-gray-100]="cat.id === selectedCategory?.id"
                class="cursor-pointer px-4 py-3 flex items-center hover:bg-gray-100 border-b d-flex justify-between">
                <div> <span class="mr-2">üìÇ</span>
                    <span>{{ cat.name }}</span>
                </div>


                <button (click)="openAddEditCategory(cat); $event.stopPropagation()"
                    class="text-blue-600 hover:underline text-sm px-2">
                    ‚úèÔ∏è
                </button>
            </li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="flex-1 p-6 overflow-y-auto">
        <div *ngIf="selectedCategory">
            <!-- Category Header -->
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-semibold">{{ selectedCategory.name }}</h2>
                    <p class="text-sm text-gray-500">{{ selectedCategory.description }}</p>


                </div>
                <button class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700"
                    (click)="openAddEditFactor(selectedCategory.id,null)">
                    <!--  -->
                    ‚ûï Add Factor
                </button>
            </div>

            <!-- Factors Table -->
            <div class="bg-white shadow rounded-lg p-4">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="border-b text-gray-600">
                            <th class="py-2 px-3">Factor</th>
                            <th class="py-2 px-3">Description</th>
                            <th class="py-2 px-3">Weight</th>
                            <th class="py-2 px-3">Data Type</th>
                            <th class="py-2 px-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let factor of selectedCategory.factors" class="border-b">
                            <td class="py-2 px-3 font-medium">{{ factor.name }}</td>
                            <td class="py-2 px-3">{{ factor.description }}</td>
                            <td class="py-2 px-3">{{ factor.weight }}</td>
                            <td class="py-2 px-3">{{ factor.data_type }}</td>
                            <td class="py-2 px-3 flex gap-2">
                                <!-- (click)="editFactor(factor)" -->
                                <!-- (click)="deleteFactor(factor.id)"
                -->
                                <button class="text-blue-600 hover:underline"
                                    (click)="openAddEditFactor(null,factor)">‚úèÔ∏è Edit</button>
                                <button class="text-red-600 hover:underline">üóëÔ∏è Delete</button>
                                <button class="text-gray-600 hover:underline" (click)="toggleValues(factor.id)">üìã
                                    Values</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Parameter Values -->
            <div *ngIf="expandedFactor" class="mt-6">
                <h3 class="text-xl font-semibold mb-4">Parameter Values for "{{ expandedFactor.name }}"</h3>
                <button class="mb-3 px-4 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700"
                    (click)="addParameterValue(expandedFactor.id)">
                    ‚ûï Add Value
                </button>
                <div class="bg-white shadow rounded-lg p-4">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="border-b text-gray-600">
                                <th class="py-2 px-3">Value</th>
                                <th class="py-2 px-3">Score</th>
                                <th class="py-2 px-3">Description</th>
                                <th class="py-2 px-3">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let val of expandedFactor.values" class="border-b">
                                <td class="py-2 px-3">{{ val.value }}</td>
                                <td class="py-2 px-3">{{ val.score }}</td>
                                <td class="py-2 px-3">{{ val.description }}</td>
                                <td class="py-2 px-3 flex gap-2">
                                    <button (click)="editParameterValue(val)" class="text-blue-600 hover:underline">‚úèÔ∏è
                                        Edit</button>
                                    <button (click)="deleteParameterValue(val.id)"
                                        class="text-red-600 hover:underline">üóëÔ∏è Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- Modal Component -->
<app-add-edit-category-modal [show]="showCategoryModal" [category]="editingCategory" (close)="closeCategoryModal()"
    (save)="saveCategory($event)">
</app-add-edit-category-modal>

<app-add-edit-factor-modal [show]="showFactorModal" [factor]="editingFactor" (close)="closeFactorModal()"
    (save)="saveFactor($event)">
</app-add-edit-factor-modal>